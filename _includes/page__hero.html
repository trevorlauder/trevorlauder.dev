{%- comment -%} Hero with optional overlay via CSS data attributes (no inline Liquid styles). {%- endcomment -%}
{% if page.header.image_description %}
  {% assign image_description = page.header.image_description %}
{% else %}
  {% assign image_description = page.title %}
{% endif %}
{% assign image_description = image_description | markdownify | strip_html | strip_newlines | escape_once %}

{% capture overlay_bg %}{% if page.header.overlay_color %}{{ page.header.overlay_color }}{% endif %}{% endcapture %}
{% capture overlay_img_raw %}{% if page.header.overlay_image %}url('{{ page.header.overlay_image | relative_url }}'){% endif %}{% endcapture %}
{% capture overlay_filter %}{% if page.header.overlay_filter contains 'gradient' %}{{ page.header.overlay_filter }}{% elsif page.header.overlay_filter contains 'rgba' %}linear-gradient({{ page.header.overlay_filter }}, {{ page.header.overlay_filter }}){% elsif page.header.overlay_filter %}linear-gradient(rgba(0,0,0,{{ page.header.overlay_filter }}), rgba(0,0,0,{{ page.header.overlay_filter }})){% endif %}{% endcapture %}
{% capture overlay_img %}{% if overlay_filter != '' and overlay_img_raw != '' %}{{ overlay_filter }}, {{ overlay_img_raw }}{% else %}{{ overlay_img_raw }}{% endif %}{% endcapture %}
{% assign hero_attr_data = '' %}
{% assign hero_attr_style = '' %}
{% if overlay_bg != '' %}
  {% assign hero_attr_data = hero_attr_data | append: ' data-hero-overlay-bg="true"' %}
  {% assign hero_attr_style = hero_attr_style | append: 'background-color:' | append: overlay_bg | append: ';' %}
{% endif %}
{% if overlay_img != '' %}
  {% assign hero_attr_data = hero_attr_data | append: ' data-hero-overlay-img="true"' %}
  {% assign hero_attr_style = hero_attr_style | append: 'background-image:' | append: overlay_img | append: ';background-size:contain;background-repeat:no-repeat;background-position:center;' %}
{% endif %}
{% if hero_attr_style != '' %}
  {% assign hero_attr_style = ' style="' | append: hero_attr_style | append: '"' %}
{% endif %}
{% assign hero_classes = 'page__hero' %}
{% if overlay_bg != '' or overlay_img != '' %}
  {% assign hero_classes = hero_classes | append: ' page__hero--overlay' %}
{% endif %}
<div class="{{ hero_classes }}"{{ hero_attr_data }}{{ hero_attr_style }}>
  <div class="wrapper">
    <h1 id="page-title" class="page__title" itemprop="headline">
      {% if paginator and site.paginate_show_page_num %}
        {{ site.title }}{% unless paginator.page == 1 %} {{ site.data.ui-text[site.locale].page | default: "Page" }} {{ paginator.page }}{% endunless %}
      {% else %}
        {{ page.title | default: site.title | markdownify | remove: "<p>" | remove: "</p>" }}
      {% endif %}
    </h1>
    {% if page.tagline %}
      <p class="page__lead"><span id="dynamic-tagline-initial">{{ page.tagline | markdownify | remove: "<p>" | remove: "</p>" }}</span></p>
    {% elsif page.header.show_overlay_excerpt != false and page.excerpt %}
      <p class="page__lead"><span id="dynamic-tagline-initial">{{ page.excerpt | markdownify | remove: "<p>" | remove: "</p>" }}</span></p>
    {% endif %}
    {% include page__meta.html %}
    {% if page.header.actions %}
      <p>
      {% for action in page.header.actions %}
        <a href="{{ action.url | relative_url }}" class="btn btn--primary btn--large">{{ action.label | default: site.data.ui-text[site.locale].more_label | default: "Learn More" }}</a>
      {% endfor %}
      </p>
    {% endif %}
  </div>
  {%- assign hero_teaser_base = nil -%}
  {%- if page.header.image -%}
    {%- assign hero_teaser_base = page.header.image | split:'/' | last | replace: '.svg','' | replace: '.png','' -%}
  {%- elsif page.header.teaser -%}
    {%- assign hero_teaser_base = page.header.teaser | split:'/' | last | replace: '.svg','' | replace: '.png','' -%}
  {%- elsif page.teaser -%}
    {%- assign hero_teaser_base = page.teaser | split:'/' | last | replace: '.svg','' | replace: '.png','' -%}
  {%- endif -%}
  {%- if hero_teaser_base -%}
    {%- assign hero_probe = '/assets/images/teasers/' | append: hero_teaser_base | append: '-400.png' -%}
    {%- assign hero_probe_file = site.static_files | where: 'path', hero_probe | first -%}
    {% if hero_probe_file %}
      {% include teaser-picture.html name=hero_teaser_base alt=image_description class='page__hero-image' %}
    {% elsif page.header.image %}
      <img src="{{ page.header.image | relative_url }}" alt="{{ image_description }}" class="page__hero-image">
    {% endif %}
  {%- endif -%}
  {% if page.header.caption %}
    <span class="page__hero-caption">{{ page.header.caption | markdownify | remove: "<p>" | remove: "</p>" }}</span>
  {% endif %}
</div>
